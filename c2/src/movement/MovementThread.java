package movement;

import java.time.LocalDateTime;
import java.util.ArrayList;

import broadcast.Broadcast;
import datastore.Datastore;
import datastore.Drone;
import drones.sensors.SensorInterface;
import gpig.all.schema.Coord;
import network.Message;
import network.ScanData;
import network.StatusData;
import network.StatusData.DroneState;

public class MovementThread implements Runnable {

	public double[] positions  = {
			 -1.08015775680542,
             53.95493656691787
           ,
           
             -1.0802006721496582,
             53.95502494989346
           ,
           
             -1.0802757740020752,
             53.95511333268171
           ,
           
             -1.0803186893463135,
             53.955176463130044
           ,
           
             -1.0803937911987305,
             53.95525221954189
           ,
           
             -1.0804903507232666,
             53.955346914863114
           ,
           
             -1.0805761814117432,
             53.9554542359672
           ,
           
             -1.080629825592041,
             53.9555173658994
           ,
           
             -1.0806941986083984,
             53.95559312169185
           ,
           
             -1.080780029296875,
             53.955681503275756
           ,
           
             -1.0808658599853516,
             53.95575725877
           ,
           
             -1.0809195041656494,
             53.95585195294424
           ,
           
             -1.0809946060180664,
             53.9559277081288
           ,
           
             -1.0810911655426025,
             53.9559845244269
           ,
           
             -1.081230640411377,
             53.95606027937058
           ,
           
             -1.081327199935913,
             53.95613603417663
           ,
           
             -1.0813915729522705,
             53.95625597900473
           ,
           
             -1.0814881324768066,
             53.9563443591836
           ,
           
             -1.0815203189849854,
             53.95639486205883
           ,
           
             -1.0815846920013428,
             53.95647692910062
           ,
           
             -1.081627607345581,
             53.956558995980885
           ,
           
             -1.0816812515258787,
             53.956634749880806
           ,
           
             -1.0817348957061768,
             53.95674838047265
           ,
           
             -1.0817456245422363,
             53.95690620022534
           ,
           
             -1.081756353378296,
             53.95696301519008
           ,
           
             -1.081756353378296,
             53.95707033213446
           ,
           
             -1.081777811050415,
             53.95714608510535
           ,
           
             -1.0817670822143555,
             53.95721552520778
           ,
           
             -1.081799268722534,
             53.957316528786656
           ,
           
             -1.081831455230713,
             53.957417532120836
           ,
           
             -1.0818099975585938,
             53.9574617210026
           ,
           
             -1.081756353378296,
             53.957499597149685
           ,
           
             -1.0816597938537598,
             53.957550098625624
           ,
           
             -1.0815846920013428,
             53.95760060004037
           ,
           
             -1.0814881324768066,
             53.957638476061305
           ,
           
             -1.0813164710998533,
             53.95767635204781
           ,
           
             -1.0810911655426025,
             53.95774579126709
           ,
           
             -1.0810267925262451,
             53.95777735451031
           ,
           
             -1.080951690673828,
             53.95779629244479
           ,
           
             -1.0808444023132324,
             53.957834168287945
           ,
           
             -1.080780029296875,
             53.957872044096696
           ,
           
             -1.0807156562805176,
             53.95789729461672
           ,
           
             -1.0806512832641602,
             53.95794779561095
           ,
           
             -1.0805332660675049,
             53.95802985959607
           ,
           
             -1.0804474353790283,
             53.95811823601478
           ,
           
             -1.0803723335266113,
             53.95818767449808
           ,
           
             -1.0802865028381348,
             53.958288675721846
           ,
           
             -1.0802006721496582,
             53.95833286368033
           ,
           
             -1.080082654953003,
             53.958269738011026
           ,
           
             -1.0799646377563477,
             53.95821292482697
           ,
           
             -1.0799002647399902,
             53.9581624241539
           ,
           
             -1.0798144340515137,
             53.95810561082358
           ,
           
             -1.0797393321990967,
             53.958055110020524
           ,
           
             -1.0796535015106201,
             53.958010921767666
           ,
           
             -1.0795462131500244,
             53.95794148299
           ,
           
             -1.0794603824615479,
             53.95786573146428
           ,
           
             -1.0793745517730713,
             53.9578278556498
           ,
           
             -1.0792994499206543,
             53.95778366715609
           ,
           
             -1.0792350769042969,
             53.95773316596309
           ,
           
             -1.0791170597076414,
             53.95767635204781
           ,
           
             -1.079009771347046,
             53.95760060004037
           ,
           
             -1.0789239406585693,
             53.957550098625624
           ,
           
             -1.0788381099700928,
             53.95748697177114
           ,
           
             -1.0787415504455566,
             53.957436470218745
           ,
           
             -1.07865571975708,
             53.95736703048432
           ,
           
             -1.078580617904663,
             53.95731021607012
           ,
           
             -1.0785162448883054,
             53.9572660270278
           ,
           
             -1.0784196853637695,
             53.95721552520778
           ,
           
             -1.0783767700195312,
             53.957190274274815
           ,
           
             -1.0783016681671143,
             53.95715239784672
           ,
           
             -1.0781300067901611,
             53.9572028997432
           ,
           
             -1.0780549049377441,
             53.95725340157852
           ,
           
             -1.0779368877410889,
             53.95731021607012
           ,
           
             -1.0777652263641357,
             53.95738596860517
           ,
           
             -1.0776257514953613,
             53.95744909561258
           ,
           
             -1.0775184631347656,
             53.9574301575204
           ,
           
             -1.0773682594299316,
             53.95737334319223
           ,
           
             -1.0772287845611572,
             53.95729127791486
           ,
           
             -1.0771000385284424,
             53.95723446339746
           ,
           
             -1.076885461807251,
             53.957190274274815
           ,
           
             -1.0767674446105957,
             53.95714608510535
           ,
           
             -1.0765957832336426,
             53.95708927039009
           ,
           
             -1.0764777660369873,
             53.957064019380695
           ,
           
             -1.0762953758239746,
             53.95702614283787
           ,
           
             -1.0762202739715576,
             53.95698826626067
           ,
           
             -1.0760271549224854,
             53.95693776410422
           ,
           
             -1.075887680053711,
             53.95689988744672
           ,
           
             -1.0757267475128174,
             53.95685569796948
           ,
           
             -1.0756194591522217,
             53.95681150844542
           ,
           
             -1.0755014419555664,
             53.95678625726778
           ,
           
             -1.075361967086792,
             53.95674206767011
           ,
           
             -1.0752654075622559,
             53.95671050364312
           ,
           
             -1.0751259326934814,
             53.95666631396517
           ,
           
             -1.074986457824707,
             53.95662843706106
           ,
           
             -1.0748469829559326,
             53.95658424729615
           ,
           
             -1.0746967792510986,
             53.95655268314967
           ,
           
             -1.0746002197265625,
             53.95651480614233
           ,
           
             -1.074364185333252,
             53.95644536487289
           ,
           
             -1.0742032527923584,
             53.95641380062128
           ,
           
             -1.0740959644317627,
             53.95637592348778
           ,
           
             -1.0740208625793457,
             53.95635067204634
           ,
           
             -1.0738921165466309,
             53.9563127948555
           ,
           
             -1.0737848281860352,
             53.95627491763025
           ,
           
             -1.073634624481201,
             53.95623072749064
           ,
           
             -1.0735058784484863,
             53.956192850190845
           ,
           
             -1.0733985900878904,
             53.956167598638544
           ,
           
             -1.0733234882354736,
             53.956123408385196
           ,
           
             -1.073216199874878,
             53.95606659227635
           ,
           
             -1.073065996170044,
             53.95597189858957
           ,
           
             -1.0728836059570312,
             53.95592139520202
           ,
           
             -1.0726475715637207,
             53.95587089175329
           ,
           
             -1.0725188255310059,
             53.95583301412661
           ,
           
             -1.0724008083343506,
             53.955801449411396
           ,
           
             -1.072314977645874,
             53.95575725877
           ,
           
             -1.072218418121338,
             53.95569412920103
           ,
           
             -1.072089672088623,
             53.95563731250721
           ,
           
             -1.0719609260559082,
             53.95561206061845
           ,
           
             -1.0718321800231934,
             53.955580495735994
           ,
           
             -1.0717248916625977,
             53.9555426178455
           ,
           
             -1.071639060974121,
             53.95549842692976
           ,
           
             -1.0715210437774658,
             53.95546054896472
           ,
           
             -1.0714781284332275,
             53.955422670965255
           ,
           
             -1.0713493824005127,
             53.95539110593941
           ,
           
             -1.0712313652038574,
             53.955372166912454
           ,
           
             -1.0710704326629639,
             53.9553406018484
           ,
           
             -1.070941686630249,
             53.95532797581608
           ,
           
             -1.0708129405975342,
             53.95530903676042
           ,
           
             -1.070694923400879,
             53.955283784672844
           ,
           
             -1.070544719696045,
             53.95522696741988
           ,
           
             -1.0704588890075684,
             53.955144897917826
           ,
           
             -1.0704481601715088,
             53.955075454366835
           ,
           
             -1.0704481601715088,
             53.95499338456654
           ,
           
             -1.070566177368164,
             53.95491131460473
           ,
           
             -1.070641279220581,
             53.95486080993253
           ,
           
             -1.0707807540893555,
             53.954759800404666
           ,
           
             -1.070866584777832,
             53.954677729983096
           ,
           
             -1.0709095001220703,
             53.954620911904286
           ,
           
             -1.0709738731384277,
             53.95457672001171
           ,
           
             -1.0710489749908447,
             53.95453884120934
           ,
           
             -1.0711669921875,
             53.95448833608602
           ,
           
             -1.0713279247283933,
             53.954418891441534
           ,
           
             -1.0714995861053467,
             53.95434944668143
           ,
           
             -1.0715854167938232,
             53.95431788084314
           ,
           
             -1.0717034339904785,
             53.95427368862938
           ,
           
             -1.0718214511871338,
             53.954235809551754
           ,
           
             -1.07191801071167,
             53.95421055681422
           ,
           
             -1.0721004009246826,
             53.95417267767922
           ,
           
             -1.0721969604492188,
             53.95415373809882
           ,
           
             -1.0723364353179932,
             53.95412848531159
           ,
           
             -1.0724437236785889,
             53.95410323250905
           ,
           
             -1.0725188255310059,
             53.95408429289712
           ,
           
             -1.0726475715637207,
             53.95407166648436
           ,
           
             -1.0727763175964355,
             53.95404010043581
           ,
           
             -1.072840690612793,
             53.95402747400969
           ,
           
             -1.0729694366455078,
             53.95400853436334
           ,
           
             -1.0730445384979248,
             53.95399590792765
           ,
           
             -1.073237657546997,
             53.95398959470838
           ,
           
             -1.0733234882354736,
             53.95397065504483
           ,
           
             -1.0734844207763672,
             53.953951715372675
           ,
           
             -1.0736024379730225,
             53.95393908891979
           ,
           
             -1.0739457607269287,
             53.953907522770834
           ,
           
             -1.0741066932678223,
             53.95387595659801
           ,
           
             -1.0742676258087158,
             53.953869643360576
           ,
           
             -1.074460744857788,
             53.953863330122196
           ,
           
             -1.0746324062347412,
             53.953844390401294
           ,
           
             -1.0747933387756348,
             53.953825450671786
           ,
           
             -1.0749971866607666,
             53.953825450671786
           ,
           
             -1.0751152038574219,
             53.953825450671786
           ,
           
             -1.0752654075622559,
             53.95381913742669
           ,
           
             -1.0754477977752686,
             53.95381282418066
           ,
           
             -1.0755658149719238,
             53.953800197685716
           ,
           
             -1.075737476348877,
             53.953800197685716
           ,
           
             -1.075887680053711,
             53.95379388443683
           ,
           
             -1.0760164260864258,
             53.95378757118695
           ,
           
             -1.0761559009552002,
             53.95374969166771
           ,
           
             -1.0763275623321533,
             53.95373706515368
           ,
           
             -1.0764563083648682,
             53.95372443863579
           ,
           
             -1.0766065120697021,
             53.95371181211407
           ,
           
             -1.0767245292663574,
             53.95371181211407
           ,
           
             -1.0768425464630127,
             53.95375600492334
           ,
           
             -1.0769176483154297,
             53.95380651093368
           ,
           
             -1.0769391059875488,
             53.953863330122196
           ,
           
             -1.076982021331787,
             53.95393908891979
           ,
           
             -1.0770142078399658,
             53.95400222114598
           ,
           
             -1.077110767364502,
             53.95410323250905
           ,
           
             -1.0771429538726807,
             53.95417267767922
           ,
           
             -1.077207326889038,
             53.9542294963688
           ,
           
             -1.0773146152496338,
             53.95428631498094
           ,
           
             -1.077432632446289,
             53.954330507181325
           ,
           
             -1.077582836151123,
             53.95437469933486
           ,
           
             -1.0776793956756592,
             53.954387325655844
           ,
           
             -1.0779154300689697,
             53.95441257828631
           ,
           
             -1.0780763626098633,
             53.954425204595815
           ,
           
             -1.0783231258392334,
             53.95443151774913
           ,
           
             -1.0784947872161865,
             53.954437830901504
           ,
           
             -1.0786128044128418,
             53.954437830901504
           ,
           
             -1.0787737369537354,
             53.95445677035288
           ,
           
             -1.0790419578552246,
             53.954469396648996
           ,
           
             -1.0791707038879395,
             53.95448833608602
           ,
           
             -1.0793423652648926,
             53.95452621493424
           ,
           
             -1.0795247554779053,
             53.95457672001171
           ,
           
             -1.0796856880187988,
             53.954627225027984
           ,
           
             -1.0797715187072754,
             53.95466510375005
           ,
           
             -1.0798466205596924,
             53.95472192176863
           ,
           
             -1.079975366592407,
             53.95478505280957
           ,
           
             -1.0801148414611816,
             53.95487343610632
           ,
           
             -1.08015775680542,
             53.95493656691787
			};
	
	private Datastore datastore;
	public MovementThread(Datastore datastore) {
		this.datastore = datastore;
	}
	@Override
	public void run() {
		int i = 0;
		System.err.println(positions.length);
		while(true){
			try {
				double loclong = positions[i];
				i++;
				double loclat = positions[i];
				Drone drone = datastore.getDroneById(Message.C2_ID);
				drone.setLocLat(loclat);
				drone.setLocLong(loclong);
				broadcastLocation(loclat,loclong);
				//Do it like a drone
				ScanData scandata = SensorInterface.getDataForPoint(loclat, loclong, "c2");
				try{
					Broadcast.broadcast(scandata.toString());
				}catch(Exception e){
					System.out.println(e.getMessage());
				}
				
				//Do it like a dude 
				Thread.sleep(4000);
				i++;
				if (i == positions.length){
					i = 0;
				}
			} catch (InterruptedException e) {
				// TODO Auto-generated catch block
				e.printStackTrace();
			}
		}

	}
	private void broadcastLocation(double loclat, double loclong) {
		StatusData message = new StatusData(Message.C2_ID, LocalDateTime.now(),loclat, loclong, 100.0, DroneState.IDLE, new double[0]);
		String messageString = message.toString();
		Broadcast.broadcast(messageString);
	}

}
